# Generated automatically from Makefile.in by configure.
#
# This Makefile may well fail without GNU Make - it relies heavily on
# built-in gmake rules...
CC = g++
prefix = /usr/local
exec_prefix = ${prefix}
bindir = ${exec_prefix}/bin

INSTALL = /usr/bin/install -c
INSTALL_PROGRAM = ${INSTALL}
INSTALL_DATA = ${INSTALL} -m 644


DEFS = -DWITH_PNG
CFLAGS =  $(DEFS) -L. -I. -L/lib -L/usr/local/lib -I/usr/include/freetype2 -I/usr/local/include
CXXFLAGS = $(CFLAGS) -g -O2
LOADLIBES = -lfreetype -lpng -lm 
FONTS = $(wildcard fonts/*.ttf)
NAMES = $(subst .ttf,, $(FONTS))
comma := ,
BASENAMES = $(subst fonts/,Font, $(subst .ttf,$(comma)\n, $(FONTS)))
BASENAMES2 = $(subst fonts/,Font, $(subst .ttf,, $(FONTS)))
HEADERS = $(subst fonts/,\n\#include "../extern/fonts/,$(subst .ttf,.h", $(FONTS)))
IMAGES = $(subst fonts/,../../fonts/, $(subst .ttf,.png, $(FONTS)))
#-lpng -lfreetype -lm -L/usr/local/lib/freetype2 -I/usr/local/include/freetype2 -ljpeg -DHAVE_LIBFREETYPE -I. -L. -L/usr/local/lib

SWITCH = $(subst fonts/,case , $(subst .ttf,:\nreturn; \n, $(FONTS)))

MAINSRC = main.c


default: all

all: font-to-texture

font-to-texture: $(MAINSRC)
	$(CC) $(MAINSRC) -o font-to-texture  $(CFLAGS) $(LOADLIBES)

run: font-to-texture
	@ \
	for i in $(NAMES); do \
		echo  $$i.ttf ../../$$i.png $$i.h; \
		./font-to-texture $$i.ttf ../../$$i.png ../../jni/extern/$$i.h; \
	done; \
	NITEMS=`ls -l fonts/*.ttf | wc -l`; \
	echo '/*Do not edit this file.  It is machine generated. */\n\n#ifndef FONTS_H_\n#define FONTS_H_'\
	'\n\nstruct FONTTABLE'\
	'\n{'\
	'\n     char ch;'\
	'\n     int x,y,x2,y2;'\
	'\n     float fx,fy,fx2,fy2;'\
	'\n};\n\n$(HEADERS)\n'\
	'\nenum FONTS {$(BASENAMES)};'\
	'\n\n#define NUMFONTS '$$NITEMS \
	'\n\nstatic FONTTABLE *GetFontTable(FONTS font)\n{\n\tswitch(font)\n\t{' > ../../jni/include/Fonts.h; \
	for i in $(BASENAMES2); do \
		DERP=`echo $$i | sed 's/^....//'`; \
		echo '\t\tcase FONTS::'$$i':\n\t\t\treturn' $$DERP'::font;' >> ../../jni/include/Fonts.h; \
	done; \
	echo '\t}\n}' >> ../../jni/include/Fonts.h; \
	echo '\n\nstatic unsigned char *GetFontData(FONTS font)\n{\n\tswitch(font)\n\t{' >> ../../jni/include/Fonts.h; \
	for i in $(BASENAMES2); do \
		DERP=`echo $$i | sed 's/^....//'`; \
		echo '\t\tcase FONTS::'$$i':\n\t\t\treturn' $$DERP'::fontimage;' >> ../../jni/include/Fonts.h; \
	done; \
	echo '\t}\n}' >> ../../jni/include/Fonts.h; \
	echo '\n\n#endif' >> ../../jni/include/Fonts.h; 

#################################################################
# all housekeeping below here...
#

# thats tags the target, and TAGS the file
tags: TAGS

# update my etags database - viva emacs!
TAGS: $(MAINSRC) $(HEADERS)
	etags $(MAINSRC) $(HEADERS)

clean: 
	rm -f *.o core font-to-texture *~ *#

realclean: clean
	rm -f config.cache Makefile config.h

distclean: realclean
	rm -f config.log config.status

install: all 
	$(INSTALL) -d $(bindir)
	$(INSTALL_PROGRAM) font-to-texture $(bindir)/font-to-texture




















